<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Soccer Formation Planner - Smooth Drag</title>
<style>
body {
    background-color: #2b2b2b;
    display: flex;
    justify-content: center;
    margin: 0;
    font-family: Arial, sans-serif;
}
#app { text-align: center; padding: 10px; }
#controls { margin-bottom: 10px; color: white; }
#field {
    position: relative;
    width: 768px;
    height: 968px;
    background: repeating-linear-gradient(90deg, #2e7d32, #2e7d32 60px, #388e3c 60px, #388e3c 120px);
    border: 4px solid white;
    border-radius: 10px;
    overflow: hidden;
}
.line { position: absolute; background: white; }
.halfway-line { width: 100%; height: 2px; top: 50%; }
.center-circle {
    position: absolute;
    width: 150px; height: 150px;
    border: 2px solid white; border-radius: 50%;
    top: calc(50% - 75px); left: calc(50% - 75px);
}
.center-spot {
    position: absolute;
    width: 6px; height: 6px; background: white; border-radius: 50%;
    top: calc(50% - 3px); left: calc(50% - 3px);
}
.penalty-box {
    border: 2px solid white; position: absolute;
    width: 360px; height: 180px; left: calc(50% - 180px);
}
.goal-area {
    border: 2px solid white; position: absolute;
    width: 160px; height: 80px; left: calc(50% - 80px);
}
.penalty-spot {
    position: absolute;
    width: 6px; height: 6px; background: white; border-radius: 50%;
    left: calc(50% - 3px);
}
.top-box { top: 0; }
.top-goal { top: 0; }
.top-spot { top: 120px; }
.bottom-box { bottom: 0; }
.bottom-goal { bottom: 0; }
.bottom-spot { bottom: 120px; }
.player-wrapper {
    position: absolute; display: flex; flex-direction: column; align-items: center;
}
.player {
    width: 60px; height: 60px; background: red; border-radius: 50%;
    text-align: center; color: white; font-weight: bold; font-size: 12px;
    cursor: grab; display: flex; flex-direction: column;
    justify-content: center; box-shadow: 0 0 5px rgba(0,0,0,0.5);
    position: relative; transition: transform 0.05s linear;
}
.player span { line-height: 1.2; }
.delete-btn {
    position: absolute; top: -5px; right: -5px;
    background: white; color: red; border-radius: 50%; width: 16px; height: 16px;
    font-size: 12px; line-height: 14px; text-align: center; cursor: pointer;
}
.subbox {
    width: 80px; background: white; color: black;
    font-size: 10px; text-align: center; margin-top: 3px;
    border-radius: 3px; padding: 2px; box-shadow: 0 0 3px rgba(0,0,0,0.3);
    position: relative;
}
.sub-delete {
    position: absolute; top: 2px; right: 2px; background: red; color: white;
    border-radius: 50%; width: 12px; height: 12px; font-size: 10px;
    line-height: 12px; text-align: center; cursor: pointer;
}
input, button, select { padding: 5px; margin: 3px; }
</style>
</head>
<body>
<div id="app">
    <div id="controls">
        <h3>Main Player</h3>
        <input type="text" id="playerName" placeholder="Player Name">
        <input type="number" id="playerNumber" placeholder="Number">
        <button onclick="addPlayer()">Add Player</button>
        <h3>Sub Player</h3>
        <input type="text" id="subName" placeholder="Sub Player Name">
        <input type="number" id="subNumber" placeholder="Number">
        <select id="mainPlayerSelect"></select>
        <button onclick="addSub()">Add Sub</button>
    </div>
    <div id="field">
        <div class="line halfway-line"></div>
        <div class="center-circle"></div>
        <div class="center-spot"></div>
        <div class="penalty-box top-box"></div>
        <div class="goal-area top-goal"></div>
        <div class="penalty-spot top-spot"></div>
        <div class="penalty-box bottom-box"></div>
        <div class="goal-area bottom-goal"></div>
        <div class="penalty-spot bottom-spot"></div>
    </div>
</div>

<script>
const field = document.getElementById('field');
const mainPlayerSelect = document.getElementById('mainPlayerSelect');
let players = [
    { name: 'Asad', number: 11, x: 350, y: 180, subs: [] },
    { name: 'Arman', number: 6, x: 150, y: 280, subs: [] },
    { name: 'Waamik', number: 10, x: 260, y: 280, subs: [] },
    { name: 'Ayon', number: 8, x: 350, y: 330, subs: [] },
    { name: 'Yamin', number: 7, x: 440, y: 280, subs: [] },
    { name: 'Amin', number: 9, x: 560, y: 280, subs: [] },
    { name: 'Rushil/Jareer', number: 2, x: 150, y: 460, subs: [] },
    { name: 'Sami', number: 3, x: 260, y: 460, subs: [] },
    { name: 'Dolon', number: 4, x: 440, y: 460, subs: [] },
    { name: 'Raiyan', number: 5, x: 560, y: 460, subs: [] },
    { name: 'Doza', number: 1, x: 350, y: 660, subs: [] }
];

function updatePlayerDropdown() {
    mainPlayerSelect.innerHTML = '';
    players.forEach((p, idx) => {
        const opt = document.createElement('option');
        opt.value = idx;
        opt.textContent = `${p.number} - ${p.name}`;
        mainPlayerSelect.appendChild(opt);
    });
}

function drawPlayers() {
    document.querySelectorAll('.player-wrapper').forEach(e => e.remove());
    players.forEach((p, idx) => {
        const wrapper = document.createElement('div');
        wrapper.classList.add('player-wrapper');
        wrapper.style.left = p.x + 'px';
        wrapper.style.top = p.y + 'px';
        const mainEl = document.createElement('div');
        mainEl.classList.add('player');
        mainEl.innerHTML = `<span>${p.number}</span><span>${p.name}</span>`;
        const delBtn = document.createElement('div');
        delBtn.classList.add('delete-btn');
        delBtn.textContent = '×';
        delBtn.onclick = () => { deletePlayer(idx); };
        mainEl.appendChild(delBtn);
        makeSmoothDraggable(wrapper, p);
        wrapper.appendChild(mainEl);
        p.subs.slice(0, 3).forEach((sub, subIdx) => {
            const subEl = document.createElement('div');
            subEl.classList.add('subbox');
            subEl.textContent = `${sub.number} - ${sub.name}`;
            const subDel = document.createElement('div');
            subDel.classList.add('sub-delete');
            subDel.textContent = '×';
            subDel.onclick = () => { deleteSub(idx, subIdx); };
            subEl.appendChild(subDel);
            wrapper.appendChild(subEl);
        });
        field.appendChild(wrapper);
    });
}

function makeSmoothDraggable(wrapper, playerObj) {
    let startX, startY, isDragging = false;

    wrapper.addEventListener('pointerdown', e => {
        isDragging = true;
        wrapper.style.transition = 'none';
        startX = e.clientX - playerObj.x;
        startY = e.clientY - playerObj.y;
        wrapper.setPointerCapture(e.pointerId);
    });

    wrapper.addEventListener('pointermove', e => {
        if (!isDragging) return;
        playerObj.x = e.clientX - startX;
        playerObj.y = e.clientY - startY;
        wrapper.style.left = playerObj.x + 'px';
        wrapper.style.top = playerObj.y + 'px';
        // Auto scroll screen when near edge
        const buffer = 50;
        if (e.clientY < buffer) window.scrollBy(0, -10);
        if (window.innerHeight - e.clientY < buffer) window.scrollBy(0, 10);
    });

    wrapper.addEventListener('pointerup', e => {
        isDragging = false;
        wrapper.releasePointerCapture(e.pointerId);
        wrapper.style.transition = 'transform 0.05s linear';
    });
}

function addPlayer() {
    const name = document.getElementById('playerName').value.trim();
    const num = document.getElementById('playerNumber').value.trim();
    if (!name || !num) { alert("Please enter both name and number"); return; }
    players.push({ name: name, number: num, x: 350, y: 400, subs: [] });
    document.getElementById('playerName').value = '';
    document.getElementById('playerNumber').value = '';
    updatePlayerDropdown();
    drawPlayers();
}

function addSub() {
    const subName = document.getElementById('subName').value.trim();
    const subNum = document.getElementById('subNumber').value.trim();
    const mainIdx = mainPlayerSelect.value;
    if (!subName || !subNum || mainIdx === '') { alert("Enter sub details."); return; }
    if (players[mainIdx].subs.length >= 3) { alert("Max 3 subs!"); return; }
    players[mainIdx].subs.push({ name: subName, number: subNum });
    document.getElementById('subName').value = '';
    document.getElementById('subNumber').value = '';
    drawPlayers();
}

function deletePlayer(playerIdx) {
    players.splice(playerIdx, 1);
    updatePlayerDropdown();
    drawPlayers();
}

function deleteSub(playerIdx, subIdx) {
    players[playerIdx].subs.splice(subIdx, 1);
    drawPlayers();
}

updatePlayerDropdown();
drawPlayers();
</script>
</body>
</html>
